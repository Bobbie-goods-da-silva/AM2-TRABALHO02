<div class="content-container">
    <h2>Alterar Usuário</h2>
    
    <div class="form-container">
        <form id="alterarForm" class="form-modern">
            <div class="input-group">
                <label for="idAlterar">ID do Usuário:</label>
                <input type="number" id="idAlterar" name="id" required>
            </div>
            
            <div class="input-group">
                <label for="nomeAlterar">Nome:</label>
                <input type="text" id="nomeAlterar" name="nome" required>
            </div>
            
            <div class="input-group">
                <label for="idadeAlterar">Idade:</label>
                <input type="number" id="idadeAlterar" name="idade" required>
            </div>
            
            <div class="input-group">
                <label for="emailAlterar">Email:</label>
                <input type="email" id="emailAlterar" name="email" required>
            </div>
            
            <div class="button-group">
                <button type="button" onclick="buscarUsuario()" class="btn-search">Buscar Usuário</button>
                <button type="submit" class="btn-primary">Alterar Usuário</button>
            </div>
        </form>
    </div>
</div>

<script>
    async function buscarUsuario() {
        const id = document.getElementById('idAlterar').value;
        if (!id) {
            showMessage('Por favor, informe o ID do usuário', 'error');
            return;
        }

        showLoader();
        try {
            const response = await fetch(`/usuarios/${id}`);
            if (response.ok) {
                const usuario = await response.json();
                document.getElementById('nomeAlterar').value = usuario.nome;
                document.getElementById('idadeAlterar').value = usuario.idade;
                document.getElementById('emailAlterar').value = usuario.email;
                showMessage('Usuário encontrado!', 'success');
            } else {
                showMessage('Usuário não encontrado', 'error');
            }
        } catch (error) {
            showMessage('Erro ao buscar usuário: ' + error.message, 'error');
        } finally {
            hideLoader();
        }
    }

    document.getElementById('alterarForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const userData = Object.fromEntries(formData);

        showLoader();
        try {
            const response = await fetch('/usuarios/' + userData.id, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(userData)
            });

            const result = await response.json();
            
            if (response.ok) {
                showMessage('Usuário alterado com sucesso!', 'success');
                this.reset();
            } else {
                showMessage(result.error || 'Erro ao alterar usuário', 'error');
            }
        } catch (error) {
            showMessage('Erro ao alterar usuário: ' + error.message, 'error');
        } finally {
            hideLoader();
        }
    });
</script>
